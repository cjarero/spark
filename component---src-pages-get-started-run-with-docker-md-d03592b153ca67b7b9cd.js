(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{F1Ga:function(e,a,c){"use strict";c.r(a),c.d(a,"_frontmatter",(function(){return b})),c.d(a,"default",(function(){return m}));var s=c("wx14"),n=c("zLVn"),t=(c("q1tI"),c("7ljp")),r=c("hhGP"),b=(c("qKvR"),{});void 0!==b&&b&&b===Object(b)&&Object.isExtensible(b)&&!b.hasOwnProperty("__filemeta")&&Object.defineProperty(b,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"src/pages/Get_started/Run_with_Docker.md"}});var p={_frontmatter:b},o=r.a;function m(e){var a=e.components,c=Object(n.a)(e,["components"]);return Object(t.b)(o,Object(s.a)({},p,c,{components:a,mdxType:"MDXLayout"}),Object(t.b)("h1",{id:"running-spark-in-docker"},"Running Spark in Docker"),Object(t.b)("p",null,"Spark can run in a Docker. This is a sample Dockerfile for running Spark."),Object(t.b)("pre",{className:"grvsc-container default-dark","data-language":"","data-index":"0"},Object(t.b)("code",Object(s.a)({parentName:"pre"},{className:"grvsc-code"}),Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"FROM mcr.microsoft.com/dotnet/core/aspnet:2.2-stretch-slim AS base")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"WORKDIR /app")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"EXPOSE 80")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"EXPOSE 443")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}))),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"FROM mcr.microsoft.com/dotnet/core/sdk:2.2-stretch AS build")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"WORKDIR /src")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),'COPY ["./src/Spark.Web/", "Spark.Web/"]')),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),'COPY ["./src/Spark.Engine/", "Spark.Engine/"]')),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),'COPY ["./src/Spark.Mongo/", "Spark.Mongo/"]')),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),'RUN dotnet restore "/src/Spark.Web/Spark.Web.csproj"')),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"COPY . .")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),'RUN dotnet build "/src/Spark.Web/Spark.Web.csproj" -c Release -o /app')),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}))),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"FROM build AS publish")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),'RUN dotnet publish "/src/Spark.Web/Spark.Web.csproj" -c Release -o /app')),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}))),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"FROM base AS final")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"WORKDIR /app")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"COPY --from=publish /app .")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"# COPY --from=build /src/Spark.Web/example_data/fhir_examples ./fhir_examples")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}))),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),'ENTRYPOINT ["dotnet", "Spark.Web.dll"]')))),Object(t.b)("p",null,"If you want to run the Mongo database as well, you could configure it with a ",Object(t.b)("inlineCode",{parentName:"p"},"docker-compse.yml"),"-file:"),Object(t.b)("pre",{className:"grvsc-container default-dark","data-language":"","data-index":"1"},Object(t.b)("code",Object(s.a)({parentName:"pre"},{className:"grvsc-code"}),Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),'version: "3"')),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"services:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"  spark:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    container_name: spark")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    restart: always")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    build:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"      context: .")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"      dockerfile: Dockerfile")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    environment:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"      - StoreSettings__ConnectionString=mongodb://root:CosmicTopSecret@mongodb:27017/spark?authSource=admin")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"      - SparkSettings__Endpoint=http://localhost:5555/fhir")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    ports:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),'      - "5555:80"')),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),'      - "44348:443"')),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    links:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"      - mongodb")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    depends_on:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"      - mongodb")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"  mongodb:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    container_name: mongodb")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    image: mongo")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    environment:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"      MONGO_INITDB_ROOT_USERNAME: root")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"      MONGO_INITDB_ROOT_PASSWORD: CosmicTopSecret")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    ports:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),'      - "17017:27017"')),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"  mongosetup:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    container_name: mongosetup")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    image: mongo")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    volumes:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"      - ./src/Spark.Web/example_data/db_dump:/data/db_dump")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    depends_on:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"      - mongodb")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    links:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"      - mongodb")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    entrypoint:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),'      ["mongorestore", "--uri=mongodb://root:CosmicTopSecret@mongodb:27017/spark", "--drop", "--archive=/data/db_dump/dstu2.archive.gz", "--gzip"]')),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"    environment:")),"\n",Object(t.b)("span",Object(s.a)({parentName:"code"},{className:"grvsc-line"}),Object(t.b)("span",Object(s.a)({parentName:"span"},{className:"grvsc-source"}),"      WAIT_HOSTS: mongodb:27017")))),Object(t.b)("style",{className:"grvsc-styles"},"\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n"))}void 0!==m&&m&&m===Object(m)&&Object.isExtensible(m)&&!m.hasOwnProperty("__filemeta")&&Object.defineProperty(m,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"src/pages/Get_started/Run_with_Docker.md"}}),m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-get-started-run-with-docker-md-d03592b153ca67b7b9cd.js.map